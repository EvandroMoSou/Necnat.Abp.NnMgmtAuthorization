@using Microsoft.Extensions.Localization;
@using System.Collections.ObjectModel
@using Necnat.Abp.NnLibCommon.Blazor.Extensions
@using Necnat.Abp.NnLibCommon.Localization
@using Necnat.Abp.NnMgmtAuthorization.Domains
@using Necnat.Abp.NnMgmtAuthorization.Localization
@using Volo.Abp.AspNetCore.Components
@using Volo.Abp.Identity
@inherits AbpComponentBase
@inject IStringLocalizer<NnLibCommonResource> NL

<Fields>
    <Validation Validator="@ValidateDisplayName">
        <Field ColumnSize="ColumnSize.Is10">
            <FieldLabel>@L[AuthEndpointConsts.DisplayNameDisplay]</FieldLabel>
            <TextEdit @bind-Text="@Entity!.DisplayName">
                <Feedback>
                    <ValidationError />
                </Feedback>
            </TextEdit>
        </Field>
    </Validation>
    <Validation Validator="@ValidateIsActive">
        <Field ColumnSize="ColumnSize.Is2">
            <FieldLabel>@L[AuthEndpointConsts.IsActiveDisplay]</FieldLabel>
            <Check TValue="bool?" @bind-Checked="@Entity!.IsActive">
                <Feedback>
                    <ValidationError />
                </Feedback>
            </Check>
        </Field>
    </Validation>
</Fields>
<Fields>
    <Validation Validator="@ValidateEndpoint">
        <Field ColumnSize="ColumnSize.Is10">
            <FieldLabel>@L[AuthEndpointConsts.EndpointDisplay]</FieldLabel>
            <TextEdit @bind-Text="@Entity!.Endpoint">
                <Feedback>
                    <ValidationError />
                </Feedback>
            </TextEdit>
        </Field>
    </Validation>
    <Validation Validator="@ValidateIsAuthentication">
        <Field ColumnSize="ColumnSize.Is2">
            <FieldLabel>@L[AuthEndpointConsts.IsAuthenticationDisplay]</FieldLabel>
            <Check TValue="bool?" @bind-Checked="@Entity!.IsAuthentication">
                <Feedback>
                    <ValidationError />
                </Feedback>
            </Check>
        </Field>
    </Validation>
</Fields>


@namespace Necnat.Abp.NnMgmtAuthorization.Blazor.Components
@code {

    [Parameter]
    public AuthEndpointDto? Entity { get; set; }

    [Parameter]
    public EventCallback<AuthEndpointDto?> EntityChanged { get; set; }

    public AuthEndpointWrapper()
    {
        LocalizationResource = typeof(NnMgmtAuthorizationResource);
    }

    void ValidateDisplayName(ValidatorEventArgs e)
    {
        e.WithError(AuthEndpointValidator.ValidateDisplayName((string?)e.Value, NL));
    }

    void ValidateEndpoint(ValidatorEventArgs e)
    {
        e.WithError(AuthEndpointValidator.ValidateEndpoint((string?)e.Value, NL));
    }

    void ValidateIsActive(ValidatorEventArgs e)
    {
        e.WithError(AuthEndpointValidator.ValidateIsActive((bool?)e.Value, NL));
    }

    void ValidateIsAuthentication(ValidatorEventArgs e)
    {
        e.WithError(AuthEndpointValidator.ValidateIsAuthentication((bool?)e.Value, NL));
    }

}